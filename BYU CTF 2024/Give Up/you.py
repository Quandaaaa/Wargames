from pwn import xor
import string

alphabet = string.printable
alphabet = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!}_ '0123456789"
# print(alphabet)
text = "351c521111461501130547003e09570b1c477f065c551f5c295155325c0c5d09171a145412130b1304461e3a14100f00507f015c55175c7f7d7f4357165d2b507f2254000e025f56501d320a591a035131061406534437552b4b7a5e10420d1d0a1a0d120054565c14553e5f1b4e4330075f111d142b14380e4759090a1006431214140313175d0b7f0844060b467f15460c79391614351e400d5d15181b0d15460f0b5f1a130b3012100601437f3b141853553a5133025d1e77251601171546160f5813130b3012101b00503a004001125d3b3e5525560f181059120c1a081a4e541f45177f1e5f1b4e412f787d1005562d1438045d171c42151017541f141b13125c05316d7e0b18512d52541a1d5d3e142d1e5d591c1016000d10461a00575657172c02421a4e4d3007393b16453a467f0c5c1713035918021f035b175c0313112d1e3a200b423a0013121c5d31557f1852005d05161a07161f1e647d1345172d475701005a3e5247101f5f7f557f075a1c5d031711431c13091a130f5c07556d670b49423a52581b1c4431143a0a50115d0d0d1d0606461d014156401d7f0b5f00093e061d4607535b3a552d1f140a5d001c100d540718065a18545e7f05451a4e4d3007140716132b5b304b401104420d1a430707024e5a02135a2c06494e074076787a1b005a3b51734b441c5d0016010b540d15014456441a3e13171d4e563a175d55145c365a384b5c175d4a1e1a0a1a015b015d5f39253a475b0001437f065b1053543e593a4b521719420e104406035b095c185d137f175c0f17143606397f325d3b14360d130012175914101f46160b131e5c057f2e17034e523a175f1c1d5455703005140d5d161c190f540b1e4e4a1946552d02101a015b7f105f1c1d577f40304b401c1868733b060203094e54195d1c3e47570718517f0b5c0053462f3e110e451c0f421e1a0d1a075b025602130b3012100a014331787d1005562d1438045d171c420b000d54070901461857523e09544e0a512c174101534a30415525560f181059120c1a081a4e5e1758177f1e5f1b4e572d0b393b16453a467f0c5c1713035906020d461c015c12510b3a6d7e0b18512d52541a1d5d3e142b0e5f155d0359190a11461a0057565b072d131017014155787d1005562d1438045d171c421e1c151146020146564602552955180b467f155c1b1d527f583a1f1300121759110c03087120560056007f005f0000557f00461b53522d5b2a0557591c0c1d550711151e1c47564a1d2a6d7e0b18512d52541a1d5d3e14320a581c5d1b160043171402647d1345172d475701005a3e5240140a13385b300f5100186837101511145b095c185d137f13550202143e525f1c16133e5a3b4b5b0c0f16590c0c016c7139565145177f0c5e01195a7f1752161b133040370e41591b0d0b55101b4617015d11392b3012424e06513e00475200133d513a0513181e0a101b045846191b47564a1d2a40420b4e40301d13061b4a7f40304b401804421001435c12144e40174a5236131964275a2c1b57105f1328517f095c0d1542121b0c03460c06520214017f05550b0014381d5a1b1413305a7f435416140c1e550c1a4f71395656581c3010101a06517f15521816133e5a3b4b441c5a101c55041b08150f13065f132647591a643e1652590000477f433e055d185d161c190f541f141b131e5c057f2e17034e523a175f1c1d545573301f47185d0f181e06541f141b13035d163a15431a0f5a3b78393b16453a467f0c5c17130359120a02035b175c0313072f6d7e0b18512d52541a1d5d3e14330e4759040d0c55071b1115647d1345172d475701005a3e5241001d133e46301e5d1d5d031711431003080b4102130b30123a200b423a0013121c5d31557f0652121842001a1654050917393856043a151009015a31131306124a7f533004571b0407733b060203094e54195d1c3e47440b02587f1313191a567f55310f131108100d551a1b1371647d1345172d475701005a3e52541c05567f4d301e130c0d6837101511145b095c185d137f0b551a4e4d300713111c44313e110e451c0f421e1a0d1a075b1c461813132d0845000a143e1c575517562c512d1f13001217733b060203094e54195d1c3e475d0f05517f0b5c0053502d4d5525560f181059120c1a081a4e40174a5238085f0a0c4d3a787d1005562d1438045d171c420d100f18461a4e5f1f56523e09544e06412d06130c1c46553e110e451c0f421e1a0d1a075b095a0056522608454e1b44553c560316417f5330055d185d0e1c01430d090e4e5719441c552955180b467f155c1b1d527f462a0513180f0d0c1b075407150a131256013a15444e175b2a787d1005562d1438045d171c421414081146020146565000266d7e0b18512d52541a1d5d3e142c0a4a591a0d1611010d037120560056007f005f0000557f0656191f133e14330256591c0c1d550b01140f4e4a1946"
flag = b"byuctf{n3v3r_g0nn4_r3us3_4_k3y}"

text = bytes.fromhex(text)
split_text = [text[i*31:(i+1)*31] for i in range(len(text)//31)]
print(len(split_text))
dictionary = dict()
for _, i in enumerate(split_text):
    dictionary[_] = xor(i, flag + (31-len(flag))*b'\x00')
    print(_, " ", dictionary[_])
print(xor(split_text[5], b"wanna tell you how I'm feeling ")[:len(b"wanna tell you how I'm feeling ")])

# print(xor(bytes.fromhex(text), flag + 22*b'\x00'))
# print(len(b'''We\'re ncjp$tXr5ri$\x0b`\'7f)J%3I>u(jc|o6kfhgb=|Cas{f+\x1dx)6c:\x04\x1f\x0664b;P2\x06W7thy=/%~Fl"xz$Rrr}1=B6_-\x01<i7nilaoku7":o7G*x:%Ke&d~`MoZw2:}lkd:gw`ehu$~\x1c|"}i?\nv2j\x02[oaVj&v?lmxys=mr*ygmKpisb7\x19@va&6N7H`$k\x14Qpzul3u{>hqrEqd}{2Cu#ut&YG F"icr gonna,-j&c\x19e=b;"[\x1e\x06r|#N`^\x7f?ni!avl6faxgt\'gH\x18\x1d\x7f~*O+!yi;EvTk>-zktyxs2|{5/"tXd9x78Ss_@t<O%\x0bj\'ujv:ldda"b?wujOgOC\x7f$Abjg\x7f)W.\x1da\'c)cmx~c|j\x02\x06q<bN31zb#K13vd=\x06 \x1cs<g?zbr7zhkcfl(a.\x0f\x1e~*6\\):bi\'ErAh)d>ykfd\x7f3~u\'-"d\nh+fr\\\x7fh%s5 X,X|`l&been acd#m7*\x19~\'c;.DaoeofH/V0"hq!y|8e~w-.dh8Us*:a;\x14\x01\x0fxt<@3\n>\'h;{tx~7ysz&/1yJul\x7f7#Yc;.v%C9L-\'u$?}nlac"t>+_^X>.cu%\x04d"e0 X"X2\'tm$ur=s`/o\'z$f\x1cc:tumCeM\x19I?BaUyu{pn,wdy=trf}(c\x04Lnv-&\\l=eh7!\x16Kgmx>bzbm-~}:,b$,Xad|z9\x06e<h{,\x1d9E(4zc\n\nNever,-l>hX<5~m2\x0bm\'b*3LJwu\'ez!j|vx~.a"dhiIgs~g8S\x01\x08sq0VvAq>cz9iyx7soz$a"1Jo/,s$Oc\'z13E"!C-mae:fjajc;=c>l\x1dg*x:1Vi@Nu1\\=\x1du)tge"d{x%hg\'p(~Y\x19\x18pz(X1 |f?GaHz9n?z,z~w=xy"5/aVqibb53\x03\x1fip5YrCf$b\x7f6xgwh3au -${ J!~p$\x06`?o{)\x1d!O|gfiu down\nB/u5t\x19{=yu6\x0bf=y*\'N/L~5 ioi3|slk\x7f301\x7fS\x18\x1d\x7f~*O+!yi;EvK\x7f;h;`ty6t`d\x1f\x1fj0tY!,cy/]&&ohjM8Di*ba\x1dTdsjv"|?l;h\x1dj avrE0&iugX!Y2.o{p"nut\x0f\x05_-3<b\x1cx8z{#\nt&p`qI5Tz\'"yt~6d}=ux(rMMKp;;e%X{%+upI7Agjm}~v`f!3zo!-(d_#6m5"Ihpr}1\x1d9E(4~\x7f it (to,9b)&Ph{\x1dR9X},r&fK%\x19r>t`!f}wa?ye&doc\x06p6\x7ffoZd/x`uK8\x0667brw|,yy;\x17B4/-\x7fDvkx\x7f$\x1ca4ctjK9O-?~#e\x7f!b`jlzpr9hD>,y\x10Xm0 uc3\x198\\|({)pg{v!|`}h|%p\x1cZqx,+Ot+zf6,\x06Sk!c?vm}r2dvbf`)pAw:ol.]\x03[Bc&N \x04n%bpw?ih{v8c:xq~Z\x0e\nmc3T\'7n{&\\mFm3?\x7f'''))
# print(xor(b'\x1b\x13', b'ur'))