from sage.all import *
from pwn import remote
from Crypto.Util.number import bytes_to_long as b2l, long_to_bytes as l2b


io = remote("titan.picoctf.net", 60941)


p1 = l2b(2)
p2 = l2b(4)

p3 = l2b(3)
p4 = l2b(6)
p5 = l2b(9)
# io.recvuntil(b'E --> encrypt D --> decrypt. \n')
# io.sendline(b'E')

# io.recvuntil(b'enter text to encrypt (encoded length must be less than keysize): ')
# io.sendline(p5)
# io.interactive()



c1 = 5067313465613043651275429665315895824157755779222372979446076012356324498190828210335763979330272318657269048435311897896433721115606764442199497891219230
c2 = 3017991195591473160519227163154887492354894842159076845017755882495838003363662298358078787383446579472698220519468805065861686403734952375766552982993440
c3 = 1532192554268896698736983775924049298295860910937868448986971625135866766317049964740119341699987512359880478384090866655316906566691064161862411306887326
c6 = 1739092941169688731535830552969191106693677280008443940145978794250207429415132922808223289748262841707372527855019061814821573622140171815180632482655660
c9 = 2054124854785158210649482254623625246187999207700182775678277179546042415886312560320106429704781228954235909828067217487511529230193536248512771275124236
# print(p1)
# print(p2)
# print(p12)
# print(p3)
# print(p13)
n = 5507598452356422225755194020880876452588463543445995226287547479009566151786764261801368190219042978883834809435145954028371516656752643743433517325277971
e = 1765037049764047724348114634473658734830490852066061345686916365658618194981097216750929421734812911680434647401939068526285652985802740837961814227312100
with open("secret.enc", 'rb') as data:
    data = data.read()

# cipher = b2l(data)
# m = pow(cipher, d, n)
# print(l2b(m))
n = gcd(gcd(c1**2 - c2, c1*c3 - c6), c3**2 - c9)

print(n)
print(gcd(c1**2 - c2, c1*c3 - c6))
print(gcd(c1**2 -c2, c3**2 - c9))

key = 36306635300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

